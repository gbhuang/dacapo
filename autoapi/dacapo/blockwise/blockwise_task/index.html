<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dacapo.blockwise.blockwise_task &mdash; DaCapo  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="dacapo.blockwise.predict_worker" href="../predict_worker/index.html" />
    <link rel="prev" title="dacapo.blockwise.argmax_worker" href="../argmax_worker/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            DaCapo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">DaCapo API:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.blockwise</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../compute_context/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.compute_context</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../experiments/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.experiments</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ext/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.ext</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../gp/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.gp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../store/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.store</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cli.html">CLI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">DaCapo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo</span></code></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.blockwise</span></code></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.blockwise.blockwise_task</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/dacapo/blockwise/blockwise_task/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dacapo.blockwise.blockwise_task">
<span id="dacapo-blockwise-blockwise-task"></span><h1><a class="reference internal" href="#module-dacapo.blockwise.blockwise_task" title="dacapo.blockwise.blockwise_task"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dacapo.blockwise.blockwise_task</span></code></a><a class="headerlink" href="#module-dacapo.blockwise.blockwise_task" title="Link to this heading"></a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dacapo.blockwise.blockwise_task.DaCapoBlockwiseTask" title="dacapo.blockwise.blockwise_task.DaCapoBlockwiseTask"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DaCapoBlockwiseTask</span></code></a></p></td>
<td><p>Definition of a <code class="docutils literal notranslate"><span class="pre">daisy</span></code> task that is to be run in a block-wise</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="dacapo.blockwise.blockwise_task.DaCapoBlockwiseTask">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dacapo.blockwise.blockwise_task.</span></span><span class="sig-name descname"><span class="pre">DaCapoBlockwiseTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_roi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">daisy.Roi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_roi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">daisy.Roi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_roi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">daisy.Roi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream_tasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dacapo.blockwise.blockwise_task.DaCapoBlockwiseTask" title="Link to this definition"></a></dt>
<dd><p>Definition of a <code class="docutils literal notranslate"><span class="pre">daisy</span></code> task that is to be run in a block-wise
fashion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<code class="docutils literal notranslate"><span class="pre">string</span></code>) – The unique name of the task.</p></li>
<li><p><strong>(</strong><strong>`class</strong> (<em>write_roi</em>) – <p>daisy.Roi`):</p>
<p>The region of interest (ROI) of the complete volume to process.</p>
</p></li>
<li><p><strong>(</strong><strong>`class</strong> – <p>daisy.Roi`):</p>
<p>The ROI every block needs to read data from. Will be shifted over
the <code class="docutils literal notranslate"><span class="pre">total_roi</span></code> to cover the whole volume.</p>
</p></li>
<li><p><strong>(</strong><strong>`class</strong> – <p>daisy.Roi`):</p>
<p>The ROI every block writes data from. Will be shifted over the
<code class="docutils literal notranslate"><span class="pre">total_roi</span></code> to cover the whole volume.</p>
</p></li>
<li><p><strong>process_function</strong> (<em>function</em>) – <p>A function that will be called as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">process_function</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</pre></div>
</div>
<p>with <code class="docutils literal notranslate"><span class="pre">block</span></code> being the shifted read and write ROI for each
location in the volume.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">read_write_conflict</span></code> is <code class="docutils literal notranslate"><span class="pre">True`,</span> <span class="pre">the</span> <span class="pre">callee</span> <span class="pre">can</span> <span class="pre">assume</span> <span class="pre">that</span>
<span class="pre">there</span> <span class="pre">are</span> <span class="pre">no</span> <span class="pre">read/write</span> <span class="pre">concurencies,</span> <span class="pre">i.e.,</span> <span class="pre">at</span> <span class="pre">any</span> <span class="pre">given</span> <span class="pre">point</span> <span class="pre">in</span>
<span class="pre">time</span> <span class="pre">the</span> <span class="pre">``read_roi</span></code> does not overlap with the <code class="docutils literal notranslate"><span class="pre">write_roi</span></code> of
another process.</p>
</p></li>
<li><p><strong>check_function</strong> (<em>function</em><em>, </em><em>optional</em>) – <p>A function that will be called as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check_function</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</pre></div>
</div>
<p>This function should return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the block was completed.
This is used internally to avoid processing blocks that are already
done and to check if a block was correctly processed.</p>
<p>If a tuple of two functions is given, the first one will be called
to check if the block needs to be run, and if so, the second one
will be called after it was run to check if the run succeeded.</p>
</p></li>
<li><p><strong>init_callback_fn</strong> (<em>function</em><em>, </em><em>optional</em>) – <p>A function that Daisy will call once when the task is started.
It will be called as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">init_callback_fn</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <cite>context</cite> is the <cite>daisy.Context</cite> string that can be used
by the daisy clients to connect to the server.</p>
</p></li>
<li><p><strong>read_write_conflict</strong> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>, optional) – Whether the read and write ROIs are conflicting, i.e., accessing
the same resource. If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, all blocks can run at the
same time in parallel. In this case, providing a <code class="docutils literal notranslate"><span class="pre">read_roi</span></code> is
simply a means of convenience to ensure no out-of-bound accesses
and to avoid re-computation of it in each block.</p></li>
<li><p><strong>fit</strong> (<code class="docutils literal notranslate"><span class="pre">string</span></code>, optional) – <p>How to handle cases where shifting blocks by the size of
<code class="docutils literal notranslate"><span class="pre">write_roi</span></code> does not tile the <code class="docutils literal notranslate"><span class="pre">total_roi</span></code>. Possible options
are:</p>
<p>”valid”: Skip blocks that would lie outside of <code class="docutils literal notranslate"><span class="pre">total_roi</span></code>. This
is the default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|---------------------------|</span>     <span class="n">total</span> <span class="n">ROI</span>

<span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>                <span class="n">block</span> <span class="mi">1</span>
       <span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>         <span class="n">block</span> <span class="mi">2</span>
                                  <span class="n">no</span> <span class="n">further</span> <span class="n">block</span>
</pre></div>
</div>
<p>”overhang”: Add all blocks that overlap with <code class="docutils literal notranslate"><span class="pre">total_roi</span></code>, even if
they leave it. Client code has to take care of save access beyond
<code class="docutils literal notranslate"><span class="pre">total_roi</span></code> in this case.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|---------------------------|</span>     <span class="n">total</span> <span class="n">ROI</span>

<span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>                <span class="n">block</span> <span class="mi">1</span>
       <span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>         <span class="n">block</span> <span class="mi">2</span>
              <span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>  <span class="n">block</span> <span class="mi">3</span> <span class="p">(</span><span class="n">overhanging</span><span class="p">)</span>
</pre></div>
</div>
<p>”shrink”: Like “overhang”, but shrink the boundary blocks’ read and
write ROIs such that they are guaranteed to lie within
<code class="docutils literal notranslate"><span class="pre">total_roi</span></code>. The shrinking will preserve the context, i.e., the
difference between the read ROI and write ROI stays the same.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|---------------------------|</span>     <span class="n">total</span> <span class="n">ROI</span>

<span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>                <span class="n">block</span> <span class="mi">1</span>
       <span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">wwwwww</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>         <span class="n">block</span> <span class="mi">2</span>
              <span class="o">|</span><span class="n">rrrr</span><span class="o">|</span><span class="n">www</span><span class="o">|</span><span class="n">rrrr</span><span class="o">|</span>     <span class="n">block</span> <span class="mi">3</span> <span class="p">(</span><span class="n">shrunk</span><span class="p">)</span>
</pre></div>
</div>
</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of parallel processes to run.</p></li>
<li><p><strong>max_retries</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of times a task will be retried if failed
(either due to failed post check or application crashes or network
failure)</p></li>
<li><p><strong>timeout</strong> (<em>int</em><em>, </em><em>optional</em>) – Time in seconds to wait for a block to be returned from a worker.
The worker is killed (and the block retried) if this time is
exceeded.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../argmax_worker/index.html" class="btn btn-neutral float-left" title="dacapo.blockwise.argmax_worker" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../predict_worker/index.html" class="btn btn-neutral float-right" title="dacapo.blockwise.predict_worker" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, William Patton, David Ackerman, Jan Funke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>